This example is based on the blog post:

https://www.waitingforcode.com/apache-spark-streaming/graceful-shutdown-explained/read

In relation to that blog post I have put a question on Stackoverflow:

https://stackoverflow.com/questions/60362149/spark-streaming-how-many-batches-are-processed-after-graceful-shutdown 

This blog post describes the overall procedure on how to gracefully stop a Spark Streaming job:

https://www.linkedin.com/pulse/how-shutdown-spark-streaming-job-gracefully-lan-jiang